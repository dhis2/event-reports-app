import isFunction from 'd2-utilizr/lib/isFunction';

import { InstanceManager } from 'd2-analysis';

export { InstanceManager };

InstanceManager.prototype.getReport = function(layout, isFavorite, skipState, forceUiState, fn) {
    var t = this,
        refs = t.getRefs();

    // var { indexedDbManager } = refs;

    var { Response } = refs.api;

    var _fn = function() {
        if (!skipState) {
            t.setState(layout, isFavorite, false, forceUiState);
        }

        (fn || t.getFn())(layout);
    };

    // layout
    if (!layout) {
        layout = t.getLayout();

        if (!layout) {
            return;
        }
    }

    // validation
    if (isFunction(layout.val) && !layout.val()) {
        return;
    }

    t.uiManager.mask();

    // response
    // var response = layout.getResponse();

    var dataRes = {"headers":[{"name":"pi","column":"Enrollment","valueType":"TEXT","type":"java.lang.String","hidden":false,"meta":true},{"name":"tei","column":"Tracked entity instance","valueType":"TEXT","type":"java.lang.String","hidden":false,"meta":true},{"name":"enrollmentdate","column":"Enrollment date","valueType":"DATE","type":"java.util.Date","hidden":false,"meta":true},{"name":"incidentdate","column":"Incident date","valueType":"DATE","type":"java.util.Date","hidden":false,"meta":true},{"name":"geometry","column":"Geometry","valueType":"TEXT","type":"java.lang.String","hidden":false,"meta":true},{"name":"longitude","column":"Longitude","valueType":"NUMBER","type":"java.lang.Double","hidden":false,"meta":true},{"name":"latitude","column":"Latitude","valueType":"NUMBER","type":"java.lang.Double","hidden":false,"meta":true},{"name":"ouname","column":"Organisation unit name","valueType":"TEXT","type":"java.lang.String","hidden":false,"meta":true},{"name":"oucode","column":"Organisation unit code","valueType":"TEXT","type":"java.lang.String","hidden":false,"meta":true},{"name":"ou","column":"Organisation unit","valueType":"TEXT","type":"java.lang.String","hidden":false,"meta":true},{"name":"bx6fsa0t90x","column":"MCH BCG dose","valueType":"BOOLEAN","type":"java.lang.Boolean","hidden":false,"meta":true},{"name":"lNNb3truQoi","column":"MCH IPT dose","valueType":"TEXT","type":"java.lang.String","hidden":false,"meta":true,"optionSet":"nH8Y04zS7UV"}],"metaData":{"pager":{"page":1,"total":493,"pageSize":100,"pageCount":5},"items":{"pXDp3sN3xJ7":{"code":"IPT 2","name":"IPT 2"},"bx6fsa0t90x":{"name":"MCH BCG dose"},"lNNb3truQoi":{"name":"MCH IPT dose"},"IpHINAT79UW":{"name":"Child Programme"},"ZzYYXq4fJie":{"name":"Baby Postnatal"},"ou":{"name":"Organisation unit"},"KGtyXqAprCc":{"code":"IPT 3","name":"IPT 3"},"A03MvHHogjR":{"name":"Birth"},"O6uvpzGd5pu":{"name":"Bo"},"lqMX3VoXyDs":{"code":"On CTX","name":"On CTX"},"BszlRcyvU2p":{"code":"IPT 1","name":"IPT 1"}},"dimensions":{"bx6fsa0t90x":[],"lNNb3truQoi":["BszlRcyvU2p","pXDp3sN3xJ7","KGtyXqAprCc","lqMX3VoXyDs"],"pe":[],"ou":["O6uvpzGd5pu"]}},"width":12,"height":100,"rows":[["ygDTsAB0cT2","DZKJQmtW0jJ","2019-05-01 02:00:00.0","2019-05-01 02:00:00.0","","0.0","0.0","Ngelehun CHC","OU_559","DiszpKrYNg8","",""],["KxXkjF6buFN","uhubxsfLanV","2019-04-02 02:00:00.0","2019-04-02 02:00:00.0","","0.0","0.0","Ngelehun CHC","OU_559","DiszpKrYNg8","",""],["JMgRZyeLWOo","PQfMcpmXeFE","2019-03-06 00:00:00.0","2019-03-04 00:00:00.0","","0.0","0.0","Ngelehun CHC","OU_559","DiszpKrYNg8","",""],["y3gLiccuvqe","pGKYFCZS2Jx","2019-03-27 12:05:00.0","2019-03-27 12:05:00.0","","0.0","0.0","Fatibra CHP","OU_73735","jfV49JGnYKF","1","IPT 2"],["OWCGHTwN8fo","bSwfoWh9Se2","2019-02-09 12:05:00.0","2019-02-09 12:05:00.0","","0.0","0.0","Yemoh MCHP","OU_8394","dx4NOnoGtE7","1","IPT 2"],["s2mjvIKI3Tf","nSI1YyOTcnB","2019-02-16 12:05:00.0","2019-02-16 12:05:00.0","","0.0","0.0","Teibor MCHP","OU_1046","kFur7xPhpH9","1","On CTX"],["d41gtQ1R0Fh","BFKTHNUWxYX","2019-05-06 12:05:00.0","2019-05-06 12:05:00.0","","0.0","0.0","Sumbuya CHC","OU_1050","W2KnxOMvmgE","0","IPT 3"],["mM4jIAtVuqW","EmCqN013uW2","2019-05-18 12:05:00.0","2019-05-18 12:05:00.0","","0.0","0.0","Wallehun MCHP","OU_678886","tZxqVn3xNrA","0","On CTX"],["VvupqPZQ3zc","aacYMaBYRTH","2019-01-28 12:05:00.0","2019-01-28 12:05:00.0","","0.0","0.0","Nafaya MCHP","OU_849","KQFAul3T9xz","0","IPT 1"],["yZ2vYrPCR3H","aheqrgVDyWW","2019-01-01 12:05:00.0","2019-01-01 12:05:00.0","","0.0","0.0","Feiba CHP","OU_1054","r4W2vzlmPhm","1","IPT 2"],["LFIIT7NrcA2","qxqJiL4gTvk","2019-05-02 12:05:00.0","2019-05-02 12:05:00.0","","0.0","0.0","Paramedical CHC","OU_834","tSBcgrTDdB8","1","IPT 2"],["AFb6DaI357J","nRhYoBGV6q2","2019-02-07 12:05:00.0","2019-02-07 12:05:00.0","","0.0","0.0","Ngolahun CHC","OU_678887","wwM3YPvBKu2","1","IPT 3"],["apAIvmIVRwy","za8HM0fmuol","2019-05-20 12:05:00.0","2019-05-20 12:05:00.0","","0.0","0.0","Harvest Time MCHP","OU_1023","VrDA0Hn4Xc6","0","On CTX"],["MU2KSaZRbPy","AxooFE5Cisn","2019-03-22 12:05:00.0","2019-03-22 12:05:00.0","","0.0","0.0","Bum Kaku MCHP","OU_619","EJoI3HArJ2W","0","IPT 2"],["GV53derkBQv","MglVyQnGatg","2019-04-03 12:05:00.0","2019-04-03 12:05:00.0","","0.0","0.0","Mokpende MCHP","OU_644","am6EFqHGKeU","1","On CTX"],["OuxthCG3MIr","ag2OTizN2El","2019-04-04 12:05:00.0","2019-04-04 12:05:00.0","","0.0","0.0","Taninahun (BN) CHP","OU_630","kEkU53NrFmy","1","IPT 2"],["Mf8kjbSuZwg","LDZGjXYhzmR","2019-01-25 12:05:00.0","2019-01-25 12:05:00.0","","0.0","0.0","Niagorehun MCHP","OU_678891","WOk7efLlLSj","1","On CTX"],["KwtwpgwoQtp","zrdbYcrv7oA","2019-04-12 12:05:00.0","2019-04-12 12:05:00.0","","0.0","0.0","Gbangba MCHP","OU_8399","r93q83kZoR9","0","On CTX"],["cb8axBplrfb","jRuqxlT5FtP","2019-03-02 12:05:00.0","2019-03-02 12:05:00.0","","0.0","0.0","Kasse MCHP","OU_621","cJkZLwhL8RP","0","IPT 2"],["K3T9oOACaoZ","HGCGSR7ij53","2019-02-15 12:05:00.0","2019-02-15 12:05:00.0","","0.0","0.0","Pelewahun (Baoma) MCHP","OU_24767","KfUCAQoOIae","1","IPT 2"],["QvWzDIjyYdL","zRp2B3kXyf0","2019-03-07 12:05:00.0","2019-03-07 12:05:00.0","","0.0","0.0","Paramedical CHC","OU_834","tSBcgrTDdB8","0","IPT 1"],["Xrly9KGPK6a","OpZsOKVcsAp","2019-05-20 12:05:00.0","2019-05-20 12:05:00.0","","0.0","0.0","Mokoba MCHP","OU_73729","xt08cuqf1ys","1","IPT 1"],["uuvKmNTCNR9","QUSkWnsVQTg","2019-03-31 12:05:00.0","2019-03-31 12:05:00.0","","0.0","0.0","Kpetewoma CHP","OU_1058","mGmu0GJ5neg","1","On CTX"],["Ky1sNMD0uFB","E4apgOwYlMW","2019-02-26 12:05:00.0","2019-02-26 12:05:00.0","","0.0","0.0","Gbotima MCHP","OU_845","i7qaYfmGVDr","0","IPT 2"],["f8hJAxB4RoY","k975wKaPFnz","2019-03-03 12:05:00.0","2019-03-03 12:05:00.0","","0.0","0.0","Grima CHP","OU_1142","NLN0MvWv9tl","1","IPT 3"],["Hd3E5F1Kims","tahFLmYUo5g","2019-04-17 12:05:00.0","2019-04-17 12:05:00.0","","0.0","0.0","Gbangbalia MCHP","OU_623","ctMepV9p92I","0","IPT 2"],["F4gLUCCaGf4","jVxTf2hJKgO","2019-01-13 12:05:00.0","2019-01-13 12:05:00.0","","0.0","0.0","Gbotima MCHP","OU_845","i7qaYfmGVDr","1","IPT 3"],["nxELUZF6Gqg","JLGcYfmV72t","2019-01-09 12:05:00.0","2019-01-09 12:05:00.0","","0.0","0.0","Gbangbalia MCHP","OU_623","ctMepV9p92I","1","On CTX"],["XKkOX1C976P","ViJrrrDF4BK","2019-04-18 12:05:00.0","2019-04-18 12:05:00.0","","0.0","0.0","Sam Lean's MCHP","OU_8380","H0OkaM4ReRK","0","IPT 2"],["bzzhXNixmpT","ZZ19t2JXwOf","2019-04-09 12:05:00.0","2019-04-09 12:05:00.0","","0.0","0.0","Gondama (Tikonko) CHC","OU_1100","jhtj3eQa1pM","0","IPT 1"],["kaYenhLaAkT","zCmDGNlNnNo","2019-05-16 12:05:00.0","2019-05-16 12:05:00.0","","0.0","0.0","Kambawama MCHP","OU_678894","GjWQK6UA4FO","1","IPT 1"],["u3TMB0b56YW","Q8rxp4B6ylK","2019-02-17 12:05:00.0","2019-02-17 12:05:00.0","","0.0","0.0","Komboya Gbauja MCHP","OU_1043","JiEz2VDLwHY","0","On CTX"],["bwdr1uukqQ4","n4YmiBC4oOj","2019-01-25 12:05:00.0","2019-01-25 12:05:00.0","","0.0","0.0","Harvest Time MCHP","OU_1023","VrDA0Hn4Xc6","0","IPT 3"],["eaRzfHm3xOQ","RCpLOMaXnn2","2019-03-11 12:05:00.0","2019-03-11 12:05:00.0","","0.0","0.0","Jembe CHC","OU_578","Umh4HKqqFp6","0","IPT 2"],["gYbBamSbFl1","OPxIjnmA9x8","2019-03-29 12:05:00.0","2019-03-29 12:05:00.0","","0.0","0.0","Mercy Ship Hospital","OU_73747","bqtZrXoryDF","0","IPT 1"],["AuXSxG1k3vn","ouVZUwvlImA","2019-04-14 12:05:00.0","2019-04-14 12:05:00.0","","0.0","0.0","Mokoba MCHP","OU_73729","xt08cuqf1ys","0","On CTX"],["dpe5s5R842r","FdXyfhWDxV9","2019-02-26 12:05:00.0","2019-02-26 12:05:00.0","","0.0","0.0","Griema MCHP","OU_1109","KR0jLuFOB3d","0","IPT 2"],["k88PAUoMb3u","kGkysJRff3p","2019-04-10 12:05:00.0","2019-04-10 12:05:00.0","","0.0","0.0","Manjama UMC CHC","OU_969","Z9ny6QeqsgX","1","IPT 3"],["xNuVqQGY8ob","FI28cirM7oB","2019-03-30 12:05:00.0","2019-03-30 12:05:00.0","","0.0","0.0","Gbangbalia MCHP","OU_623","ctMepV9p92I","0","IPT 3"],["m0VgxvjTGBW","rac90yM8Zz2","2019-02-04 12:05:00.0","2019-02-04 12:05:00.0","","0.0","0.0","Mokoba MCHP","OU_73729","xt08cuqf1ys","0","IPT 3"],["aRes2DpgJbI","aEe58O2SbPv","2019-02-04 12:05:00.0","2019-02-04 12:05:00.0","","0.0","0.0","Mokoba MCHP","OU_73729","xt08cuqf1ys","1","IPT 1"],["yrMmQamVMBP","PV8oPtdocb3","2019-03-28 12:05:00.0","2019-03-28 12:05:00.0","","0.0","0.0","Marie Stopes (Kakua) Clinic","OU_8522","kLNQT4KQ9hT","0","IPT 1"],["E3ney0KfwKc","gMZ0yZF2abK","2019-02-22 12:05:00.0","2019-02-22 12:05:00.0","","0.0","0.0","Momajo MCHP","OU_625","fA43H8Ds0Ja","0","IPT 1"],["dBHpGuWxXdo","cPHLAnjCCAO","2019-05-07 12:05:00.0","2019-05-07 12:05:00.0","","0.0","0.0","Nengbema CHC","OU_1082","rm60vuHyQXj","0","IPT 2"],["KD6nwBVGlu3","n3gbZD61LtK","2019-05-30 12:05:00.0","2019-05-30 12:05:00.0","","0.0","0.0","Mano Yorgbo MCHP","OU_627","KvE0PYQzXMM","0","IPT 2"],["W1f6qpTVBax","soQ1MqzZPJF","2019-01-24 12:05:00.0","2019-01-24 12:05:00.0","","0.0","0.0","Barlie MCHP","OU_2732","y5hLlID8ihI","0","IPT 2"],["qNe1Q5C5RUz","sTdgnbWVSil","2019-04-28 12:05:00.0","2019-04-28 12:05:00.0","","0.0","0.0","Mano Yorgbo MCHP","OU_627","KvE0PYQzXMM","1","On CTX"],["jVEF8XX4VV9","xYcgWAusQFb","2019-02-26 12:05:00.0","2019-02-26 12:05:00.0","","0.0","0.0","Mano Yorgbo MCHP","OU_627","KvE0PYQzXMM","1","On CTX"],["ppukDy05eWO","XLLFtTGk8nW","2019-03-22 12:05:00.0","2019-03-22 12:05:00.0","","0.0","0.0","Bo Govt. Hosp.","OU_15","rZxk3S0qN63","0","On CTX"],["Ok9cc4oBxlD","mTsAp2qJ7My","2019-01-07 12:05:00.0","2019-01-07 12:05:00.0","","0.0","0.0","Fatibra CHP","OU_73735","jfV49JGnYKF","1","IPT 1"],["bb66WlzbGYc","vrt4EQQZt0p","2019-04-18 12:05:00.0","2019-04-18 12:05:00.0","","0.0","0.0","Grima CHP","OU_1142","NLN0MvWv9tl","1","IPT 3"],["j7lV5zQIdZ9","G4U0AP1hBdR","2019-05-14 12:05:00.0","2019-05-14 12:05:00.0","","0.0","0.0","Bo Govt. Hosp.","OU_15","rZxk3S0qN63","1","IPT 3"],["o2u2DDL8Q5B","Utlaxdtzmsw","2019-05-13 12:05:00.0","2019-05-13 12:05:00.0","","0.0","0.0","Mongere CHC","OU_1122","PC3Ag91n82e","0","IPT 3"],["NOEOAoS2W2A","GKubz3mPEiu","2019-05-18 12:05:00.0","2019-05-18 12:05:00.0","","0.0","0.0","Bum Kaku MCHP","OU_619","EJoI3HArJ2W","0","IPT 2"],["eL2ZuKZll4g","pJPlFD7vfPZ","2019-03-18 12:05:00.0","2019-03-18 12:05:00.0","","0.0","0.0","Mbundorbu MCHP","OU_581","EuoA3Crpqts","0","IPT 2"],["ElByeBn9OTg","IQhSeppytOK","2019-03-07 12:05:00.0","2019-03-07 12:05:00.0","","0.0","0.0","Kassama MCHP","OU_1117","yh1PrRTboyg","0","On CTX"],["MbtxauPG2ZR","sUsJoDpnZ28","2019-04-06 12:05:00.0","2019-04-06 12:05:00.0","","0.0","0.0","Serabu Hospital Mission","OU_167623","Tht0fnjagHi","1","IPT 1"],["q9YSVthOBIe","SMABiZS3Cxs","2019-04-25 12:05:00.0","2019-04-25 12:05:00.0","","0.0","0.0","Yakaji MCHP","OU_583","AnXoUM1tfNT","0","IPT 1"],["DDKkJmiCUGm","gbvQ6A781UH","2019-01-23 12:05:00.0","2019-01-23 12:05:00.0","","0.0","0.0","Golu MCHP","OU_577","azRICFoILuh","1","IPT 1"],["xU7MVTCLbMi","AwKS9aW8lOM","2019-04-21 12:05:00.0","2019-04-21 12:05:00.0","","0.0","0.0","Needy CHC","OU_172174","UOJlcpPnBat","0","On CTX"],["hGDv7KMBhrC","GfdhZEtIgQN","2019-03-20 12:05:00.0","2019-03-20 12:05:00.0","","0.0","0.0","Holy Mary Hospital","OU_172178","jk1TtiBM5hz","1","On CTX"],["JIbhe9aSoL4","UJaGTlGscZn","2019-03-19 12:05:00.0","2019-03-19 12:05:00.0","","0.0","0.0","Benduma MCHP","OU_602","Wr8kmywwseZ","0","IPT 1"],["RJOJpUkcIVb","S4qsjwpGwqG","2019-02-20 12:05:00.0","2019-02-20 12:05:00.0","","0.0","0.0","Mattru on the Rail MCHP","OU_1114","Qu0QOykPdcD","0","IPT 3"],["kQzrnigxl1w","P4yDPBXE3jO","2019-02-02 12:05:00.0","2019-02-02 12:05:00.0","","0.0","0.0","Bumpe CHC","OU_651","E497Rk80ivZ","1","IPT 1"],["KfcWVOwtNzb","ChuF1MYEw6b","2019-02-06 12:05:00.0","2019-02-06 12:05:00.0","","0.0","0.0","Sahn CHC","OU_952","PuZOFApTSeo","1","IPT 1"],["qQPLyY7ByLE","KFr30gasF8V","2019-05-04 12:05:00.0","2019-05-04 12:05:00.0","","0.0","0.0","Agape CHP","OU_678892","GvFqTavdpGE","1","IPT 2"],["wK3HGw9jMYt","RyVvvy1IVWY","2019-05-20 12:05:00.0","2019-05-20 12:05:00.0","","0.0","0.0","Kpewama MCHP","OU_1156","DcmSvQd5N8c","0","IPT 3"],["da7kmeItqjy","juLpwxVjAAZ","2019-02-04 12:05:00.0","2019-02-04 12:05:00.0","","0.0","0.0","Kpewama MCHP","OU_1156","DcmSvQd5N8c","0","IPT 2"],["rExRPGoHoLo","eyvnGuEWlSU","2019-01-20 12:05:00.0","2019-01-20 12:05:00.0","","0.0","0.0","Maguama CHP","OU_8382","ltF8BmYAXpQ","1","On CTX"],["igvgcYr0DIs","zDxuJXdQbEz","2019-02-16 12:05:00.0","2019-02-16 12:05:00.0","","0.0","0.0","Fanima (Wonde) MCHP","OU_1169","Q23tMsKOoO6","0","On CTX"],["gJ75OIdXoxL","TcUffUlE0Ym","2019-02-18 12:05:00.0","2019-02-18 12:05:00.0","","0.0","0.0","Tengbewabu MCHP","OU_109308","gfWvbbgdjoS","1","On CTX"],["ZoG36EvJqqc","M6BQ3Gw9Vjh","2019-02-26 12:05:00.0","2019-02-26 12:05:00.0","","0.0","0.0","Mattru on the Rail MCHP","OU_1114","Qu0QOykPdcD","1","On CTX"],["xWl8Qv3CJ3b","b6DmopM51Kf","2019-04-12 12:05:00.0","2019-04-12 12:05:00.0","","0.0","0.0","Sembehun Mamagewor MCHP","OU_678888","lvxIJAb2QJo","1","IPT 1"],["IlQerXxWDJn","dwzqZpvUCU1","2019-03-29 12:05:00.0","2019-03-29 12:05:00.0","","0.0","0.0","Fanima (Wonde) MCHP","OU_1169","Q23tMsKOoO6","1","On CTX"],["KvRwrKexvNU","TCbUMxa787g","2019-03-19 12:05:00.0","2019-03-19 12:05:00.0","","0.0","0.0","Sumbuya CHC","OU_1050","W2KnxOMvmgE","0","IPT 3"],["bAZvPfv6YyQ","aHrQZmP8fxq","2019-02-21 12:05:00.0","2019-02-21 12:05:00.0","","0.0","0.0","Gbanja Town MCHP","OU_841","E9oBVjyEaCe","0","On CTX"],["r2LljDXEBaz","AubH9rLDZUJ","2019-05-02 12:05:00.0","2019-05-02 12:05:00.0","","0.0","0.0","Manjama Shellmingo CHC","OU_832","lOv6IFgr6Fs","0","IPT 3"],["J6Os0O1W8Qy","kfA2rB0Dr02","2019-01-08 12:05:00.0","2019-01-08 12:05:00.0","","0.0","0.0","Kigbai MCHP","OU_580","egv5Es0QlQP","0","On CTX"],["PztMoqbqGm6","Hal4Eri2SHn","2019-04-04 12:05:00.0","2019-04-04 12:05:00.0","","0.0","0.0","Ngelehun CHC","OU_559","DiszpKrYNg8","1","IPT 1"],["qChrd0zVhIx","bFcwMYeETxZ","2019-05-12 12:05:00.0","2019-05-12 12:05:00.0","","0.0","0.0","Mamboma MCHP","OU_828","w3vRmEz3J7t","0","IPT 2"],["Cj8HpKWsbMo","t4cGPQhGTZt","2019-02-01 12:05:00.0","2019-02-01 12:05:00.0","","0.0","0.0","Gboyama CHC","OU_1161","k1Y0oNqPlmy","1","IPT 2"],["Ptn95GSAqao","ci4dsI4CMj2","2019-04-29 12:05:00.0","2019-04-29 12:05:00.0","","0.0","0.0","Mendewa MCHP","OU_598","YWXXO0XMkQe","0","IPT 2"],["WgGX4HbVluc","fvYJoghcwOL","2019-03-30 12:05:00.0","2019-03-30 12:05:00.0","","0.0","0.0","Mbundorbu MCHP","OU_581","EuoA3Crpqts","0","IPT 2"],["c3GSbcgA2CE","bLPLFEe26FV","2019-02-23 12:05:00.0","2019-02-23 12:05:00.0","","0.0","0.0","Teibor MCHP","OU_1046","kFur7xPhpH9","0","IPT 1"],["LSCcnHDEdlY","pcmEokB2TJ1","2019-03-25 12:05:00.0","2019-03-25 12:05:00.0","","0.0","0.0","New Police Barracks CHC","OU_836","mzsOsz0NwNY","1","IPT 1"],["FXUZ4b5AuxJ","Bit7MHqO2L0","2019-01-13 12:05:00.0","2019-01-13 12:05:00.0","","0.0","0.0","Grima CHP","OU_1142","NLN0MvWv9tl","0","IPT 3"],["ACwpyg1qzpb","uVqgE6DWZzB","2019-04-24 12:05:00.0","2019-04-24 12:05:00.0","","0.0","0.0","Kasse MCHP","OU_621","cJkZLwhL8RP","0","IPT 2"],["OpnDvGYCtLC","i35cd4TOOqj","2019-03-15 12:05:00.0","2019-03-15 12:05:00.0","","0.0","0.0","Mano-Jaiama CHP","OU_822","hLGkoHmvBgI","1","IPT 3"],["LdZJxSBrKvw","zVe6K4cY4Sl","2019-04-29 12:05:00.0","2019-04-29 12:05:00.0","","0.0","0.0","Lyn Maternity MCHP","OU_73733","k6DIO9LIEk9","1","IPT 2"],["j3cG2d9QpVj","pzRYElAdjNq","2019-05-09 12:05:00.0","2019-05-09 12:05:00.0","","0.0","0.0","Sembehun Mamagewor MCHP","OU_678888","lvxIJAb2QJo","0","On CTX"],["U9UMVQBdB98","qFgdEcRSsOX","2019-05-06 12:05:00.0","2019-05-06 12:05:00.0","","0.0","0.0","Gondama (Tikonko) CHC","OU_1100","jhtj3eQa1pM","1","IPT 3"],["Ib2D2KnazeV","ILv6Zammunk","2019-03-14 12:05:00.0","2019-03-14 12:05:00.0","","0.0","0.0","Kpetema CHP","OU_639","RTixJpRqS4C","1","IPT 3"],["q5ED827l62K","KWlIMARpW51","2019-02-03 12:05:00.0","2019-02-03 12:05:00.0","","0.0","0.0","Sumbuya CHC","OU_1050","W2KnxOMvmgE","0","On CTX"],["CTztxd82d4D","KG5o9rZ0Gcx","2019-04-26 12:05:00.0","2019-04-26 12:05:00.0","","0.0","0.0","Njala CHC","OU_1038","QsAwd531Cpd","1","IPT 2"],["Nl8SLA3qCLQ","qyTcVIJ9Omg","2019-05-29 12:05:00.0","2019-05-29 12:05:00.0","","0.0","0.0","Benduma MCHP","OU_602","Wr8kmywwseZ","0","IPT 1"],["rlSNZOe9Lyz","KXNh6vnBPoF","2019-02-02 12:05:00.0","2019-02-02 12:05:00.0","","0.0","0.0","Agape CHP","OU_678892","GvFqTavdpGE","0","IPT 2"],["hYHy2FpqhpL","OLwZx3YwyQU","2019-01-17 12:05:00.0","2019-01-17 12:05:00.0","","0.0","0.0","Yemoh MCHP","OU_8394","dx4NOnoGtE7","1","IPT 1"],["MbXxEnJF0e1","xv9DSNCVVyd","2019-03-08 12:05:00.0","2019-03-08 12:05:00.0","","0.0","0.0","Paramedical CHC","OU_834","tSBcgrTDdB8","1","IPT 1"],["GhyCn0bdkNE","wOUSdhVKQsi","2019-04-06 12:05:00.0","2019-04-06 12:05:00.0","","0.0","0.0","Niagorehun MCHP","OU_678891","WOk7efLlLSj","0","IPT 1"],["WCdjNUq1izu","a5TRCzIw0Oh","2019-01-18 12:05:00.0","2019-01-18 12:05:00.0","","0.0","0.0","Bucksal Clinic","OU_1010","vRC0stJ5y9Q","1","IPT 3"]]};

    var response = new Response(refs, dataRes);
    layout.setResponse(response);


    // fn
    if (response) {
       _fn();
    }
    else {
        layout.data().done(function(res) {
            layout.setResponse(new Response(refs, res));

            _fn();

            // (NO LONGER USING INDEXEDDB)

            // var optionSetIds = res.headers.filter(h => !!h.optionSet).map(h => h.optionSet);

            // var fn = function() {
                // layout.setResponse(new Response(refs, res));

                // _fn();
            // };

            // init
            // if (optionSetIds.length) {
            //     indexedDbManager.getOptionSets(optionSetIds, fn);
            // }
            // else {
            //     fn();
            // }
        });
    }
};
